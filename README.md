# JUDGMENT-LOG — 設計ドキュメント

## 概要

JUDGMENT-LOGは、意思決定を評価・助言・最適化するためのツールではない。

**過去の自分の判断を鏡として、問いを返すための記録システム**である。

本ドキュメントは、思想・データ設計・AI設計・技術構成を一貫した設計意図としてまとめた公式設計資料である。

---

## 根幹思想

### 答えは出さない。問いを返す。

JUDGMENT-LOGは、AIが正解を提示することを目的としない。

* 判断に良し悪しをつけない
* 行動を最適化しない
* ユーザーの代わりに決断しない

AIの役割は、**過去の判断を構造化して再提示し、問いを投げ返すことだけ**に限定される。

目的は一つ。

> 自分の判断を問い続けられる人間になること

---

## AIの役割定義

AIは以下の4機能のみを持つ。

1. 似た過去の判断を探す
2. 当時の制約を復元する
3. 現在との違いを可視化する
4. 問いを投げる

### 禁止事項

* アドバイスの提供
* 判断の評価
* 正解・最適解の提示

これらは**システムプロンプトと出力構造によって強制的に封じられる**。

---

## データモデル設計

### Judgmentモデル

判断の記録は、以下の4要素に集約される。

| フィールド        | 内容          | 設計意図         |
| ------------ | ----------- | ------------ |
| content      | 何を決めたか（1行）  | 判断の本質を言語化させる |
| premise      | 前提・制約（1–2行） | 文脈の保存        |
| alternatives | 選ばなかった選択肢   | 分岐点の可視化      |
| personaTag   | 判断時の自分像     | 過去の自己再現      |

### 状態三軸（State Triad）

判断時のコンテキストを、以下3軸で定量化する。

| 軸      | 値                       | 意味    |
| ------ | ----------------------- | ----- |
| energy | high / mid / low        | 体力    |
| time   | plenty / normal / tight | 時間的余裕 |
| mind   | clear / normal / cloudy | 心理状態  |

同一人物でも状態が違えば判断は変わる。
その差分を検出するための最低限の指標。

### Reflectionモデル

| フィールド    | 内容          |
| -------- | ----------- |
| response | AIが生成した問い   |
| answer   | ユーザーの回答（任意） |

判断 → 問い → 回答

この**思考の連鎖**自体を記録対象とする。

---

## AI設計

### 使用モデル

* Claude Sonnet 4.5
* モデルID: `claude-sonnet-4-5-20250929`

### システムプロンプト設計

プロンプトは「やること」より「やってはいけないこと」を定義する。

* 助言しない
* 評価しない
* 答えを出さない

### 出力フォーマット（固定）

```
【あなたはこの時こうでした】
・判断：（内容）
・当時の状態：体力○○ / 時間○○ / 心○○
・制約：（前提の要約）

【今との違い】
・変わった前提：（あれば）
・変わってない前提：（あれば）

【問い】
今だったら、どう判断しますか？
```

構造によってAIの暴走を防ぐ設計。

---

## 類似判断検索設計

### 方針

* ベクトル検索は使わない
* 全件スキャン前提
* 個人スケール最適化

### スコアリング

* キーワード一致: +3
* タグ一致: +5
* 状態一致（各軸）: +2

スコア > 0 のものを降順で最大3件返却。

### 意図

* 外部依存を排除
* データは常にユーザーのDB内
* 数百〜数千件規模で十分高速

---

## 技術スタック

### フロントエンド

* Next.js 14 (App Router)
* React 18
* TypeScript (strict)
* Tailwind CSS
* next-pwa

### カラー設計

* **kimi（金）**: 判断ログ
* **ruri（瑠璃）**: AIの問い

人間とAIの役割を視覚的に分離。

### バックエンド

* Next.js API Routes
* Prisma + PostgreSQL
* NextAuth (Google OAuth)
* Anthropic SDK

### インフラ

* Vercel（サーバーレス）
* 外部PostgreSQL
* OAuth認証のみ

---

## API構成

| メソッド   | パス                          | 内容     |
| ------ | --------------------------- | ------ |
| GET    | /api/judgments              | 一覧取得   |
| POST   | /api/judgments              | 判断作成   |
| GET    | /api/judgments/[id]         | 詳細取得   |
| PATCH  | /api/judgments/[id]         | 更新     |
| DELETE | /api/judgments/[id]         | 削除     |
| POST   | /api/judgments/[id]/reflect | AI問い生成 |
| PATCH  | /api/reflections/[id]       | 回答保存   |

### セキュリティ

* 全APIで所有権検証
* middlewareでルート保護
* 公開ページは最小限

---

## UI設計

### 状態セレクタ

* ● / ◐ / ○ の記号表現
* 言語依存を排除

### JudgmentCard

* タグ色で分類
* 評価はしない

### ReflectionView

* AI出力を構造パース
* 回答はインライン編集

---

## ランディングページ思想

* 否定形から始める
* 誤解を先に潰す
* 仕組みを具体例で示す

マーケティングより思想優先。

---

## CI / CD

* GitHub Actions
* lint → typecheck → build
* Node.js 20

---

## 設計総括

JUDGMENT-LOGは引き算の設計。

* 記録は最小
* AIは沈黙気味
* 技術は過剰にしない

すべては一つの目的に収束する。

**自分の判断を問い続けられる人間になるために**
